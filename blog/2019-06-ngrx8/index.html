<!DOCTYPE html><html><head lang="de" prefix="og: http://ogp.me/ns# book: http://ogp.me/ns/book#"><meta name="generator" content="Scully 0.0.0">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" type="image/x-icon" href="favicon.ico">

  <title>Angular-Buch ‚Üí NgRx v8 ‚Äì das neue Major-Release ist da</title>
  

  

  <meta property="book:author" content="https://www.facebook.com/ferdinand.malcher">
  <meta property="book:author" content="https://www.facebook.com/johannes.hoppe">
  <meta property="book:author" content="https://www.facebook.com/dannykoppenhagen">

  <meta property="book:isbn" content="9783864907791">
  <meta property="book:release_date" content="2020-09-30">
  <meta property="book:tag" content="Angular">
  <meta property="book:tag" content="AngularJS">
  <meta property="book:tag" content="TypeScript">
  <meta property="book:tag" content="JavaScript">
  <meta property="book:tag" content="HTML5">
  <meta property="book:tag" content="CSS">
  <meta property="book:tag" content="RxJS">
  <meta property="book:tag" content="NativeScript">
  <meta property="book:tag" content="Redux">
  <meta property="book:tag" content="NgRx">

  <base href="/">
<style>@font-face{font-family:Roboto;src:url(Roboto-Thin.3025beb410a67d09.eot);src:local("Roboto Thin"),local("Roboto-Thin"),url(Roboto-Thin.3025beb410a67d09.eot?#iefix) format("embedded-opentype"),url(Roboto-Thin.a529f43f8b43a41b.woff2) format("woff2"),url(Roboto-Thin.0cfb6189823d7275.woff) format("woff"),url(Roboto-Thin.94d67324d95f59e5.ttf) format("truetype"),url(Roboto-Thin.761d85cbad1d4c0a.svg#Roboto) format("svg");font-weight:100;font-style:normal}@font-face{font-family:Roboto;src:url(Roboto-ThinItalic.3c0494ed5066eddf.eot);src:local("Roboto ThinItalic"),local("Roboto-ThinItalic"),url(Roboto-ThinItalic.3c0494ed5066eddf.eot?#iefix) format("embedded-opentype"),url(Roboto-ThinItalic.7d4425d4f9dfbd4d.woff2) format("woff2"),url(Roboto-ThinItalic.72445820525e265f.woff) format("woff"),url(Roboto-ThinItalic.72ab0263ccb0dc3f.ttf) format("truetype"),url(Roboto-ThinItalic.7d3f4f17bca5edb0.svg#Roboto) format("svg");font-weight:100;font-style:italic}@font-face{font-family:Roboto;src:url(Roboto-Light.9cff5f27f6ad3d59.eot);src:local("Roboto Light"),local("Roboto-Light"),url(Roboto-Light.9cff5f27f6ad3d59.eot?#iefix) format("embedded-opentype"),url(Roboto-Light.7117d83fbb0aa28a.woff2) format("woff2"),url(Roboto-Light.2188ea3f3f8ab51a.woff) format("woff"),url(Roboto-Light.5605865fb101be1a.ttf) format("truetype"),url(Roboto-Light.775a1d8f32378e56.svg#Roboto) format("svg");font-weight:300;font-style:normal}@font-face{font-family:Roboto;src:url(Roboto-LightItalic.4a75ae9969c094a3.eot);src:local("Roboto LightItalic"),local("Roboto-LightItalic"),url(Roboto-LightItalic.4a75ae9969c094a3.eot?#iefix) format("embedded-opentype"),url(Roboto-LightItalic.9669ba38989190d7.woff2) format("woff2"),url(Roboto-LightItalic.ead2698c38e2d858.woff) format("woff"),url(Roboto-LightItalic.ccdc52ada30d970f.ttf) format("truetype"),url(Roboto-LightItalic.293a6c412ebb5682.svg#Roboto) format("svg");font-weight:300;font-style:italic}@font-face{font-family:Roboto;src:url(Roboto-Regular.b21a0eefbec4f57f.eot);src:local("Roboto Regular"),local("Roboto-Regular"),url(Roboto-Regular.b21a0eefbec4f57f.eot?#iefix) format("embedded-opentype"),url(Roboto-Regular.e64b7e5db276537f.woff2) format("woff2"),url(Roboto-Regular.2313f68c10458709.woff) format("woff"),url(Roboto-Regular.b796ce65a81adc41.ttf) format("truetype"),url(Roboto-Regular.18c20975d2f2578c.svg#Roboto) format("svg");font-weight:400;font-style:normal}@font-face{font-family:Roboto;src:url(Roboto-RegularItalic.e6e0d5b40d74c833.eot);src:local("Roboto RegularItalic"),local("Roboto-RegularItalic"),url(Roboto-RegularItalic.e6e0d5b40d74c833.eot?#iefix) format("embedded-opentype"),url(Roboto-RegularItalic.d448549043fc24e3.woff2) format("woff2"),url(Roboto-RegularItalic.6c93c3855305929c.woff) format("woff"),url(Roboto-RegularItalic.c6469a92f47f72b9.ttf) format("truetype"),url(Roboto-RegularItalic.f83754e74962d444.svg#Roboto) format("svg");font-weight:400;font-style:italic}@font-face{font-family:Roboto;src:url(Roboto-Medium.9a9c9421bcdef79c.eot);src:local("Roboto Medium"),local("Roboto-Medium"),url(Roboto-Medium.9a9c9421bcdef79c.eot?#iefix) format("embedded-opentype"),url(Roboto-Medium.31c42d9dbee477e5.woff2) format("woff2"),url(Roboto-Medium.769ea541b3eef14d.woff) format("woff"),url(Roboto-Medium.03501557d620ee6b.ttf) format("truetype"),url(Roboto-Medium.8a59a67632175b0b.svg#Roboto) format("svg");font-weight:500;font-style:normal}@font-face{font-family:Roboto;src:url(Roboto-MediumItalic.eda8bf9be9c607a9.eot);src:local("Roboto MediumItalic"),local("Roboto-MediumItalic"),url(Roboto-MediumItalic.eda8bf9be9c607a9.eot?#iefix) format("embedded-opentype"),url(Roboto-MediumItalic.2b1343b2d0b09b92.woff2) format("woff2"),url(Roboto-MediumItalic.226e2a5000081685.woff) format("woff"),url(Roboto-MediumItalic.ce75fe30feef2519.ttf) format("truetype"),url(Roboto-MediumItalic.b51310a741b5d779.svg#Roboto) format("svg");font-weight:500;font-style:italic}@font-face{font-family:Roboto;src:url(Roboto-Bold.0d2870f5e1759c7a.eot);src:local("Roboto Bold"),local("Roboto-Bold"),url(Roboto-Bold.0d2870f5e1759c7a.eot?#iefix) format("embedded-opentype"),url(Roboto-Bold.6980f6575e8c2cbd.woff2) format("woff2"),url(Roboto-Bold.313d5de65a92aae6.woff) format("woff"),url(Roboto-Bold.ed694f411e0b3a82.ttf) format("truetype"),url(Roboto-Bold.a5d983d959171823.svg#Roboto) format("svg");font-weight:700;font-style:normal}@font-face{font-family:Roboto;src:url(Roboto-BoldItalic.24d4fc9379818f4d.eot);src:local("Roboto BoldItalic"),local("Roboto-BoldItalic"),url(Roboto-BoldItalic.24d4fc9379818f4d.eot?#iefix) format("embedded-opentype"),url(Roboto-BoldItalic.986a9dba772d1a7a.woff2) format("woff2"),url(Roboto-BoldItalic.d0b1358f293918c7.woff) format("woff"),url(Roboto-BoldItalic.e3188bd071401a05.ttf) format("truetype"),url(Roboto-BoldItalic.98e79b0548caa896.svg#Roboto) format("svg");font-weight:700;font-style:italic}@font-face{font-family:Roboto;src:url(Roboto-Black.2a430d2577a70997.eot);src:local("Roboto Black"),local("Roboto-Black"),url(Roboto-Black.2a430d2577a70997.eot?#iefix) format("embedded-opentype"),url(Roboto-Black.710dab121b2a7bc2.woff2) format("woff2"),url(Roboto-Black.06740b883cfa8a2e.woff) format("woff"),url(Roboto-Black.41a719429c37346e.ttf) format("truetype"),url(Roboto-Black.711c7acb0aa346bb.svg#Roboto) format("svg");font-weight:900;font-style:normal}@font-face{font-family:Roboto;src:url(Roboto-BlackItalic.65db2fd69db01cd5.eot);src:local("Roboto BlackItalic"),local("Roboto-BlackItalic"),url(Roboto-BlackItalic.65db2fd69db01cd5.eot?#iefix) format("embedded-opentype"),url(Roboto-BlackItalic.f4307ac32c9ad43b.woff2) format("woff2"),url(Roboto-BlackItalic.fc1832915de70c44.woff) format("woff"),url(Roboto-BlackItalic.ba2ec768f43dbc84.ttf) format("truetype"),url(Roboto-BlackItalic.26186c8936090567.svg#Roboto) format("svg");font-weight:900;font-style:italic}@charset "UTF-8";:root{--blue:#007bff;--indigo:#6610f2;--purple:#6f42c1;--pink:#e83e8c;--red:#dc3545;--orange:#fd7e14;--yellow:#ffc107;--green:#28a745;--teal:#20c997;--cyan:#17a2b8;--white:#fff;--gray:#6c757d;--gray-dark:#343a40;--primary:#007bff;--secondary:#6c757d;--success:#28a745;--info:#17a2b8;--warning:#ffc107;--danger:#dc3545;--light:#f8f9fa;--dark:#343a40;--breakpoint-xs:0;--breakpoint-sm:576px;--breakpoint-md:768px;--breakpoint-lg:992px;--breakpoint-xl:1200px;--font-family-sans-serif:-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";--font-family-monospace:SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace}*,*:before,*:after{box-sizing:border-box}html{font-family:sans-serif;line-height:1.15;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:rgba(0,0,0,0)}body{margin:0;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,Liberation Sans,sans-serif,"Apple Color Emoji","Segoe UI Emoji",Segoe UI Symbol,"Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;text-align:left;background-color:#fff}img{vertical-align:middle;border-style:none}svg{overflow:hidden;vertical-align:middle}@media print{*,*:before,*:after{text-shadow:none!important;box-shadow:none!important}img{page-break-inside:avoid}@page{size:a3}body{min-width:992px!important}}body{color:#1e1e1e;font-family:"Roboto","Helvetica Neue",Helvetica,Arial sans-serif;font-size:16px;line-height:1.35em;font-weight:400;background:#F8F8F8}html{overflow-y:scroll}</style><link rel="stylesheet" href="styles.b083c0140ec18768.css" media="all" onload="this.media='all'"><noscript><link rel="stylesheet" href="styles.b083c0140ec18768.css"></noscript><meta property="og:title" content="Angular-Buch ‚Üí NgRx v8 ‚Äì das neue Major-Release ist da"><meta name="twitter:title" content="Angular-Buch ‚Üí NgRx v8 ‚Äì das neue Major-Release ist da"><meta name="description" content="üìô P√ºnktlich zum Pfingstwochenende wurde am 7. Juni 2019 die neue Major-Version von NgRx ver√∂ffentlicht!
Das neue Release 8.0.0 bringt einige Neuerungen mit sich, die vor allem die Produktivit√§t des Entwicklers verbessern sollen.
Das wahrscheinlich wichtigste Feature sind die neuen Creator-Funktionen f√ºr Actions, Reducer und Effects.
Dazu kommt eine Reihe von kleineren Features, die wir in diesem Blogartikel vorstellen m√∂chten."><meta property="og:description" content="üìô P√ºnktlich zum Pfingstwochenende wurde am 7. Juni 2019 die neue Major-Version von NgRx ver√∂ffentlicht!
Das neue Release 8.0.0 bringt einige Neuerungen mit sich, die vor allem die Produktivit√§t des Entwicklers verbessern sollen.
Das wahrscheinlich wichtigste Feature sind die neuen Creator-Funktionen f√ºr Actions, Reducer und Effects.
Dazu kommt eine Reihe von kleineren Features, die wir in diesem Blogartikel vorstellen m√∂chten."><meta name="twitter:description" content="üìô P√ºnktlich zum Pfingstwochenende wurde am 7. Juni 2019 die neue Major-Version von NgRx ver√∂ffentlicht!
Das neue Release 8.0.0 bringt einige Neuerungen mit sich, die vor allem die Produktivit√§t des Entwicklers verbessern sollen.
Das wahrscheinlich wichtigste Feature sind die neuen Creator-Funktionen f√ºr Actions, Reducer und Effects.
Dazu kommt eine Reihe von kleineren Features, die wir in diesem Blogartikel vorstellen m√∂chten."><meta name="twitter:site" content="@angular_buch"><meta property="og:locale" content="de"><meta property="og:type" content="website"><meta property="og:url" content="https://angular-buch.com/blog/2019-06-ngrx8"><style>.width-6{width:6.5rem}.width-8{width:8rem}.linkImage{margin-right:3px;margin-top:-3px}
</style><style>.content img{max-width:100%}.details-page-autor{margin-top:-110px}.details-thumbnail{margin-bottom:-18px}.details-thumbnail .details-thumbnail-inner{border-bottom:23px solid #dfdede;height:300px;overflow:hidden;background-color:#fff;border-radius:4px;display:flex;justify-content:center}.details-thumbnail .details-thumbnail-inner .darken-overlay{display:block;position:absolute;height:300px;width:100%;padding-left:15px;padding-right:15px;padding-bottom:23px}.details-thumbnail .details-thumbnail-inner .darken-overlay div{display:block;position:relative;width:100%;height:100%;background-color:#0003;border-radius:4px 4px 0 0/4px 4px 0px 0px}.details-thumbnail img{width:100%;align-self:center}.video-container{position:relative;padding-bottom:56.25%;padding-top:0;height:0;overflow:hidden;margin-top:2rem;margin-bottom:2rem}.video-container iframe,.video-container object,.video-container embed{position:absolute;top:0;left:0;width:100%;height:100%}
</style><style>a[_ngcontent-wjw-c14]:link, a[_ngcontent-wjw-c14]:visited{text-decoration:underline}a[_ngcontent-wjw-c14]:hover, a[_ngcontent-wjw-c14]:active{text-decoration:none}</style><meta property="og:image" content="https://website-articles.angular-buch.com/blog/2019-06-ngrx8/./ngrx8.jpg"><meta name="twitter:image" content="https://website-articles.angular-buch.com/blog/2019-06-ngrx8/./ngrx8.jpg"><meta name="twitter:card" content="summary_large_image"><script>window['ScullyIO']='generated';</script></head>
<body scully-version="0.0.0">
  <app-root ng-version="15.0.0"><header><div class="nav__overlay"></div><div class="container"><div class="row no-gutters align-items-center"><div class="col-6 col-md-2"><a routerlink="/"><img src="assets/img/brand.svg" alt="" class="img-fluid" style="height: 40px;"></a></div><div class="col-6 col-md-10"><nav><ul><li><app-link><!----><!----><!----><a routerlinkactive="nav__current" ariacurrentwhenactive="page" href="/"><!----> Buch </a><!----><!----><!----></app-link></li><li><app-link><!----><!----><a routerlinkactive="nav__current" ariacurrentwhenactive="page" href="/blog" class="nav__current" aria-current="page"><!----> Blog </a><!----><!----><!----><!----></app-link></li><li><app-link><!----><!----><a routerlinkactive="nav__current" ariacurrentwhenactive="page" href="/material"><!----> Begleitmaterial </a><!----><!----><!----><!----></app-link></li><li><app-link><!----><a class="order" href="//angular.schule/"><img alt="" class="linkImage lazyloaded" data-src="assets/img/symbol-calendar.svg" src="assets/img/symbol-calendar.svg"><!----> Angular-Schulungen </a><!----><!----><!----><!----><!----></app-link></li><li><app-link><!----><a class="order" href="https://amzn.eu/d/8fgTIWL"><img alt="" class="linkImage lazyloaded" data-src="assets/img/symbol-basket.svg" src="assets/img/symbol-basket.svg"><!----> Jetzt vorbestellen </a><!----><!----><!----><!----><!----></app-link></li><!----></ul></nav><a href="/" class="nav__toggle"><img src="assets/img/symbol-menu.svg" alt=""></a></div></div></div></header><main><router-outlet></router-outlet><app-blog-details><app-hero-header headline="Blog" headlinelink="/blog"><section class="hero hero--smallest"><div class="hero__lines hero__lines--smallest"><div class="container"><div class="row justify-content-between"><div class="col-md-6 col-xs-12"><h1 class="headline__page headline__page--blank headline__page--space-bottom"><a style="color: white;">Blog</a><!----><!----></h1></div><div class="col-5 d-none d-md-block text-center"><img src="assets/img/angular.png" alt="" class="hero__angular--smallest"></div></div></div></div></section><a name="content" id="content"></a></app-hero-header><section class="index index--list blog"><div class="index__stripe index__stripe--list"><!----><div class="container"><a name="post" id="post"></a><div class="row details-thumbnail"><div class="col-12"><div class="details-thumbnail-inner"><img alt="" class="img-fluid rounded" src="https://website-articles.angular-buch.com/blog/2019-06-ngrx8/./ngrx8.jpg"><!----></div></div><!----></div><div class="row"><div class="col-12"><div class="index__item index__item--list"><div class="row align-items-top"><div class="col-12 col-sm-3 col-md-2 text-center details-page-autor"><img alt="" class="blog__portrait img-fluid rounded-circle" src="//www.gravatar.com/avatar/d5c9183b21d274284f9ff858b108f43b?size=200&amp;rating=pg&amp;d=mm"><span class="blog__author">Ferdinand Malcher <br><a target="_blank" class="twitter" href="https://twitter.com/fmalcher01"> @fmalcher01</a> &nbsp; <!----><!----></span></div><div class="col-12 col-sm-9 col-md-10 col-lg-10"><h1>NgRx v8 ‚Äì das neue Major-Release ist da</h1><p class="blog__date">07.06.2019</p><p class="content markdown-body"><p>P√ºnktlich zum Pfingstwochenende wurde am 7. Juni 2019 die neue Major-Version von NgRx ver√∂ffentlicht!
Das neue Release 8.0.0 bringt einige Neuerungen mit sich, die vor allem die Produktivit√§t des Entwicklers verbessern sollen.
Das wahrscheinlich wichtigste Feature sind die neuen Creator-Funktionen f√ºr Actions, Reducer und Effects.
Dazu kommt eine Reihe von kleineren Features, die wir in diesem Blogartikel vorstellen m√∂chten.</p>
<p>Lesen Sie dazu auch den offiziellen <a href="https://ngrx.io/guide/migration/v8">V8 Migration Guide</a> in der NgRx-Dokumentation.</p>
<h2 id="update-auf-ngrx-8">Update auf NgRx 8</h2>
<p>Um eine bestehende Anwendung auf das neue NgRx 8 zu aktualisieren, wird ein Update-Skript f√ºr die Angular CLI bereitgestellt:</p>
<pre><code class="language-bash">ng update <span class="hljs-title">@ngrx</span>/<span class="hljs-keyword">store</span>
</code></pre>
<p>Das Beispielprojekt <a href="https://github.com/angular-buch/book-monkey3-ngrx"><code>book-monkey3-ngrx</code></a> aus dem Angular-Buch haben wir auf diese Weise ebenfalls aktualisiert.</p>
<h2 id="creator-funktionen-f√ºr-actions-reducer-und-effects">Creator-Funktionen f√ºr Actions, Reducer und Effects</h2>
<p>Ein gro√üer Kritikpunkt an NgRx war seine Verbosit√§t: Um die Features der Bibliothek zu nutzen, musste verh√§ltnism√§√üig viel Code geschrieben werden.
Ein Beispiel sind <em>Actions</em>, die stets aus einem String-Enum, einer Klasse und einem exportierten Union-Type bestehen:</p>
<pre><code class="language-typescript"><span class="hljs-keyword">export</span> <span class="hljs-built_in">enum</span> BookActionTypes {
  LoadBooks = <span class="hljs-string">'[Book] Load Books'</span>,
  LoadBooksSuccess = <span class="hljs-string">'[Book] Load Books Success'</span>
}

<span class="hljs-keyword">export</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LoadBooks</span> <span class="hljs-title">implements</span> <span class="hljs-title">Action</span> </span>{
  <span class="hljs-keyword">readonly</span> <span class="hljs-keyword">type</span> = BookActionTypes.LoadBooks;
}

<span class="hljs-keyword">export</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LoadBooksSuccess</span> <span class="hljs-title">implements</span> <span class="hljs-title">Action</span> </span>{
  <span class="hljs-keyword">readonly</span> <span class="hljs-keyword">type</span> = BookActionTypes.LoadBooksSuccess;
  <span class="hljs-function"><span class="hljs-title">constructor</span>(<span class="hljs-params"><span class="hljs-keyword">public</span> payload: { books: Book[] }</span>)</span> { }
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">type</span> BookActions = LoadBooks | LoadBooksSuccess;
</code></pre>
<p>Bei der Umsetzung dieses Patterns kann man Fehler machen: Vergisst oder vertauscht man ein Detail, so gibt es sp√§ter einen Fehler, der nicht immer leicht zu erkennen ist. Erstellt man z.B. eine weitere Action durch Copy &amp; Paste und vers√§umt, es den Type anzupassen ‚Äì so ergibt sich ein schwer zu identifizierender Bug:</p>
<pre><code class="language-typescript"><span class="hljs-comment">// vorher ‚Äì Achtung Fehler!</span>
<span class="hljs-keyword">export</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LoadBookSuccess</span> <span class="hljs-title">implements</span> <span class="hljs-title">Action</span> </span>{
  <span class="hljs-keyword">readonly</span> <span class="hljs-keyword">type</span> = BookActionTypes.LoadBooksSuccess;
  <span class="hljs-function"><span class="hljs-title">constructor</span>(<span class="hljs-params"><span class="hljs-keyword">public</span> payload: { book: Book }</span>)</span> { }
}
</code></pre>
<p>Am meisten f√§llt aber die Menge an Code auf: Das Anlegen einer Action ist vergleichsweise aufwendig.</p>
<p>Um dieses Problem zu l√∂sen, wurden aus der Commmunity heraus verschiedene Bibliotheken entwickelt, um die Erzeugung von Actions (und Reducern und Effects) ausdrucksst√§rker zu gestalten ‚Äì darunter die Projekte <a href="https://github.com/cartant/ts-action/blob/master/packages/ts-action/README.md"><code>ts-action</code></a> und <a href="https://github.com/co-IT/ngrx-ducks"><code>ngrx-ducks</code></a>.
Die Ideen von <code>ts-action</code> wurden mit dem neuen Release schlie√ülich fest in NgRx integriert.</p>
<p>In Anlehnung an die Funktion <code>createSelector()</code> zum Erstellen von Selektoren kommen nun die neuen Funktionen <code>createAction()</code>, <code>createReducer()</code> und <code>createEffect()</code> hinzu, um die Implementierung von Actions, Reducern und Effects zu vereinfachen.
Wir m√∂chten einmal alle Bausteine in alter und neuer Schreibweise gegen√ºberstellen.</p>
<p>Das Beispielprojekt <code>book-monkey3-ngrx</code> haben wir <a href="https://github.com/angular-buch/book-monkey3-ngrx/tree/ng8creators">auf dem separaten Branch <code>ng8creators</code></a> bereits auf die neue API migriert, sodass Sie den Code am Beispiel nachvollziehen k√∂nnen.</p>
<h3 id="schematics-code-mit-creator-funktionen-generieren">Schematics: Code mit Creator-Funktionen generieren</h3>
<p>Obwohl die neuen Funktionen nun fest in NgRx integriert sind, m√ºssen Sie keinesfalls sofort umsteigen ‚Äì Sie k√∂nnen weiterhin den herk√∂mmlichen Weg verwenden.
Auch in den Schematics zu NgRx versteckt sich das neue Feature hinter einem Flag.
M√∂chten Sie Code mit Creator-Funktionen erzeugen, k√∂nnen Sie die Option <code>--creators</code> einsetzen:</p>
<pre><code class="language-bash"><span class="hljs-title">ng</span> g action foo <span class="hljs-comment">--creators</span>
<span class="hljs-title">ng</span> g reducer foo <span class="hljs-comment">--creators</span>
<span class="hljs-title">ng</span> g <span class="hljs-keyword">effect</span> foo <span class="hljs-comment">--creators</span>

ng g feature foo <span class="hljs-comment">--creators</span>
</code></pre>
<h3 id="actions-mit-createaction">Actions mit <code>createAction()</code></h3>
<p>Zum Anlegen einer Action waren bisher stets ein Eintrag im Enum f√ºr den Action-Typen, eine Action-Creator-Klasse und ein Eintrag im exportierten Union-Type n√∂tig:</p>
<pre><code class="language-typescript"><span class="hljs-comment">// vorher</span>
<span class="hljs-keyword">import</span> { Action } <span class="hljs-keyword">from</span> <span class="hljs-string">'@ngrx/store'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-built_in">enum</span> BookActionTypes {
  LoadBooks = <span class="hljs-string">'[Book] Load Books'</span>,
  LoadBooksSuccess = <span class="hljs-string">'[Book] Load Books Success'</span>
}

<span class="hljs-keyword">export</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LoadBooks</span> <span class="hljs-title">implements</span> <span class="hljs-title">Action</span> </span>{
  <span class="hljs-keyword">readonly</span> <span class="hljs-keyword">type</span> = BookActionTypes.LoadBooks;
}

<span class="hljs-keyword">export</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LoadBooksSuccess</span> <span class="hljs-title">implements</span> <span class="hljs-title">Action</span> </span>{
  <span class="hljs-keyword">readonly</span> <span class="hljs-keyword">type</span> = BookActionTypes.LoadBooksSuccess;
  <span class="hljs-function"><span class="hljs-title">constructor</span>(<span class="hljs-params"><span class="hljs-keyword">public</span> payload: { books: Book[] }</span>)</span> { }
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">type</span> BookActions = LoadBooks | LoadBooksSuccess;
</code></pre>
<p>Diese drei Bestandteile werden mit <code>createAction()</code> in einem einzigen Aufruf kombiniert.
Die Struktur des Payloads wird mittels Typparameter √ºber die Funktion <code>props()</code> definiert.</p>
<pre><code class="language-typescript"><span class="hljs-comment">// nachher</span>
<span class="hljs-keyword">import</span> { createAction, props } <span class="hljs-keyword">from</span> <span class="hljs-string">'@ngrx/store'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> loadBooks = createAction(<span class="hljs-string">'[Book] Load Books'</span>);

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> loadBooksSuccess = createAction(
  <span class="hljs-string">'[Book] Load Books Success'</span>,
  props&lt;{ <span class="hljs-attr">books</span>: Book[] }&gt;()
);
</code></pre>
<h4 id="struktur-des-payloads">Struktur des Payloads</h4>
<p>Bitte beachten Sie, dass die Payload-Propertys direkt in das Action-Objekt integriert werden ‚Äì die Daten werden nicht automatisch in ein Unterproperty <code>payload</code> geschachtelt.
Die Action <code>LoadBooksSuccess</code> hat also in diesem Beispiel die folgende Struktur:</p>
<pre><code class="language-typescript">{
  type: '[Book] Load Books Success',
  books: Book[]
}
</code></pre>
<p>Wom√∂glich haben Sie den <code>payload</code> mittlerweile lieb gewonnen ‚Äì oder Sie haben bestehenden Code, der aufwendig migriert werden m√ºsste.
Nat√ºrlich k√∂nnen Sie auch weiterhin mit dem alten Property arbeiten, wenn Sie den Type entsprechend definieren:</p>
<pre><code class="language-typescript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> loadBooksSuccess = createAction(
  <span class="hljs-string">'[Book] Load Books Success'</span>,
  props&lt;{ payload: { books: Book[] } }&gt;()
);
</code></pre>
<h4 id="action-dispatchen">Action dispatchen</h4>
<p>Um eine Action zu dispatchen, musste bisher eine Instanz der Action-Klasse erstellt werden.
Mit <code>createAction()</code> verk√ºrzt sich diese Schreibweise zu einem einfachen Funktionsaufruf:</p>
<pre><code class="language-typescript"><span class="hljs-comment">// vorher</span>
this.store.dispatch(<span class="hljs-keyword">new</span> <span class="hljs-constructor">LoadBook(<span class="hljs-params">isbn</span>)</span>);

<span class="hljs-comment">// nachher</span>
this.store.dispatch(load<span class="hljs-constructor">Book(<span class="hljs-params">isbn</span>)</span>);
</code></pre>
<h3 id="reducer-mit-createreducer">Reducer mit <code>createReducer()</code></h3>
<p>Ein Reducer entscheidet anhand einer eintreffenden Action, in welcher Weise der aktuelle State neu berechnet werden muss.
F√ºr diese Unterscheidung wird traditionell im Reducer ein <em>switch/case</em>-Statement eingesetzt, um auf bestimmte Action-Typen zu reagieren.
Diese L√∂sung ist pragmatisch, erfordert aber einiges an Aufmerksamkeit und Vorwissen: Wir k√∂nnen nicht die Action-Klasse zur Unterscheidung verwenden, sondern nur den Action-<em>Typ</em>.
Wichtig ist hier besonders, nicht den <code>default</code>-Fall zu vergessen, da sonst das System nicht korrekt funktioniert.</p>
<pre><code class="language-typescript">// vorher ‚Äì Achtung Fehler!
export function reducer(<span class="hljs-keyword">state</span> = initialState, action: BookActions): State {
  switch (action.type) {

    case BookActionTypes.LoadBooks: {
      return { ...<span class="hljs-keyword">state</span>, loading: true };
    }

    case BookActionTypes.LoadBooksSuccess: {
      return {
        ...<span class="hljs-keyword">state</span>,
        books: action.payload.books,
        loading: false
      };
    }
    
    // <span class="hljs-keyword">default</span> vergessen! :-(
}
</code></pre>
<p>Mit NgRx 8 und der neuen Funktion <code>createReducer()</code> wird diese Schreibweise verk√ºrzt und auf die wesentlichen Bestandteile reduziert:</p>
<pre><code class="language-typescript">// nachher
import { createReducer, <span class="hljs-keyword">on</span> } <span class="hljs-keyword">from</span> '@ngrx/store';
import * as BookActions <span class="hljs-keyword">from</span> '../actions/book.actions';

<span class="hljs-keyword">const</span> bookReducer = createReducer(
  initialState,

  <span class="hljs-keyword">on</span>(BookActions.<span class="hljs-built_in">load</span>Books, <span class="hljs-keyword">state</span> =&gt; {
    return { ...<span class="hljs-keyword">state</span>, loading: true };
  }),

  <span class="hljs-keyword">on</span>(BookActions.<span class="hljs-built_in">load</span>BooksSuccess, (<span class="hljs-keyword">state</span>, action) =&gt; {
    return {
      ...<span class="hljs-keyword">state</span>,
      books: action.books,
      loading: false
    };
  })
);

export function reducer(<span class="hljs-keyword">state</span>: State | undefined, action: Action): State {
  return bookReducer(<span class="hljs-keyword">state</span>, action);
}
</code></pre>
<p>Der Import <code>BookActions</code> stellt alle exportierten Actions zur Verf√ºgung, die zuvor mithilfe von <code>createAction()</code> definiert wurden.
Beachten Sie auch, dass wir aufgrund der neuen Struktur den Payload der Action nicht mehr aus dem Property <code>payload</code> beziehen, sondern direkt aus dem Action-Objekt.</p>
<h3 id="effects-mit-createeffect">Effects mit <code>createEffect()</code></h3>
<p>Der Vollst√§ndigkeit halber wird auch f√ºr Effects eine Creator-Funktion bereitgestellt.
Damit wird im Wesentlichen der Decorator <code>@Effect()</code> eingespart.</p>
<pre><code class="language-typescript"><span class="hljs-comment">// vorher</span>
import { Actions, ofType, Effect } from '@ngrx/effects';

@<span class="hljs-constructor">Injectable()</span>
export <span class="hljs-keyword">class</span> BookEffects {
  
  @<span class="hljs-constructor">Effect()</span>
  loadBooks$ = this.actions<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">$</span>.</span></span>pipe(
    <span class="hljs-keyword">of</span><span class="hljs-constructor">Type(BookActionTypes.LoadBooks)</span>,
    switch<span class="hljs-constructor">Map(()</span> =&gt;
      this.bs.get<span class="hljs-constructor">All()</span>.pipe(
        map(books =&gt; <span class="hljs-keyword">new</span> <span class="hljs-constructor">LoadBooksSuccess({ <span class="hljs-params">books</span> })</span>),
        catch<span class="hljs-constructor">Error(<span class="hljs-params">error</span> =&gt; <span class="hljs-params">of</span>(<span class="hljs-params">new</span> LoadBooksFailure({ <span class="hljs-params">error</span> })</span>)))
    )
  );

  constructor(
    <span class="hljs-keyword">private</span> actions$: Actions&lt;BookActions&gt;,
    <span class="hljs-keyword">private</span> bs: BookStoreService,
  ) {}
}
</code></pre>
<pre><code class="language-typescript"><span class="hljs-comment">// nachher</span>
import { Actions, ofType, createEffect } from '@ngrx/effects';
import<span class="hljs-operator"> * </span><span class="hljs-keyword">as</span> BookActions from '../actions/book.actions';

@<span class="hljs-constructor">Injectable()</span>
export <span class="hljs-keyword">class</span> BookEffects {
  
  loadBooks$ = create<span class="hljs-constructor">Effect(()</span> =&gt; this.actions<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">$</span>.</span></span>pipe(
    <span class="hljs-keyword">of</span><span class="hljs-constructor">Type(BookActions.<span class="hljs-params">loadBooks</span>)</span>,
    switch<span class="hljs-constructor">Map(()</span> =&gt;
      this.bs.get<span class="hljs-constructor">All()</span>.pipe(
        map(books =&gt; <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">BookActions</span>.</span></span>load<span class="hljs-constructor">BooksSuccess({ <span class="hljs-params">books</span> })</span>),
        catch<span class="hljs-constructor">Error(<span class="hljs-params">error</span> =&gt; <span class="hljs-params">of</span>(BookActions.<span class="hljs-params">loadBooksFailure</span>({ <span class="hljs-params">error</span> })</span>)))
    )
  ));

  constructor(
    <span class="hljs-keyword">private</span> actions$: Actions,
    <span class="hljs-keyword">private</span> bs: BookStoreService,
  ) {}
}
</code></pre>
<p>Bitte beachten Sie, dass die Actions hier wieder als Funktionen verwendet werden, nicht mehr als Klassen (√§hnlich wie beim Dispatchen).
Durch das neue Action-Format er√ºbrigt sich auch die Typisierung f√ºr das <code>Actions</code>-Observable, das in den Constructor injiziert wird.</p>
<h4 id="einstellungen-f√ºr-effects">Einstellungen f√ºr Effects</h4>
<p>Die Option <code>{ dispatch: false }</code>, die bisher als Argument an den Decorator √ºbergeben wurde, kann nun im zweiten Argument von <code>createEffect()</code> notiert werden.</p>
<pre><code class="language-typescript"><span class="hljs-comment">// vorher</span>
@Effect({ <span class="hljs-attr">dispatch</span>: <span class="hljs-literal">false</span> }) loadBooks$ = <span class="hljs-comment">/* ... */</span>

<span class="hljs-comment">// nachher</span>
loadBooks$ = createEffect(
  <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-comment">/* ... */</span>,
  { <span class="hljs-attr">dispatch</span>: <span class="hljs-literal">false</span> }
);
</code></pre>
<h2 id="effects-wiederaufnahme-bei-fehlern">Effects: Wiederaufnahme bei Fehlern</h2>
<p>Ein Datenstrom aus einem Observable wird bei Fehlern beendet ‚Äì das ist eine der grundlegenden Eigenschaften eines Observables.
Das gilt auch f√ºr Effects; hier allerdings kann es zu Problemen f√ºhren, wenn ein Fehler in einem Effect nicht korrekt gefangen wird.
Wird das Observable beendet, ist der Effect inaktiv und kann nicht wiederbelebt werden.</p>
<p>Dieses Problem lie√ü sich bisher nur mit Disziplin oder unsch√∂nen Hilfsmitteln l√∂sen, z.B. ein Operator, der Fehler verschluckt und damit das Observable am Leben h√§lt (<a href="https://gist.github.com/JohannesHoppe/6c52f721c42f19b8c63cf563f5665a81">siehe Beispiel</a>).</p>
<p>Mit NgRx in Version 8 wurde dieses Verhalten ge√§ndert: Tritt ein Fehler im Effect auf, so wird automatisch eine neue Subscription erzeugt, sodass der Effect weiter aktiv ist.
Diese √Ñnderung ist ein Breaking Change!
Ben√∂tigen Sie einen Effect ohne Resubscribe, so k√∂nnen Sie die Einstellung deaktivieren:</p>
<pre><code class="language-typescript">loadBooks$ = createEffect(
  <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-comment">/* ... */</span>,
  { <span class="hljs-attr">resubscribeOnError</span>: <span class="hljs-literal">false</span> }
);
</code></pre>
<h2 id="runtime-checks-immutability-und-serialisierbarkeit">Runtime Checks: Immutability und Serialisierbarkeit</h2>
<p>Zwei wichtige Eigenschaften von NgRx sind <em>Immutability</em> und <em>Serialisierbarkeit</em>.
Das bedeutet, dass Actions und Zust√§nde niemals ver√§ndert werden d√ºrfen.
Stattdessen m√ºssen wir z.B. im Reducer stets einen <em>neuen</em> State erzeugen, anstatt den aktuellen zu √§ndern.</p>
<p>Das Thema Serialisierbarkeit von Actions und State sorgt schlie√ülich daf√ºr, dass diese Objekte stets problemlos in JSON serialisiert werden k√∂nnen, ohne dass Informationen verloren gehen.</p>
<p>Die Einhaltung dieser beiden "Auflagen" ist essentiell f√ºr NgRx.
Beide Regeln sind allerdings nicht immer offensichtlich.
Das Paket <code>ngrx-store-freeze</code> half deshalb bisher dabei, unbeabsichtigte Mutationen zu entdecken.
Diese Funktionalit√§t und weitere Pr√ºfungen wurden nun direkt in NgRx integriert, und es werden <em>Runtime Checks</em> durchgef√ºhrt.
Dabei k√∂nnen vier verschiedene Regeln gepr√ºft werden:</p>
<ul>
<li><code>strictStateImmutability</code>: State muss immutable behandelt werden</li>
<li><code>strictActionImmutability</code>: Actions m√ºssen immutable behandelt werden</li>
<li><code>strictStateSerializability</code>: State muss serialisierbar sein</li>
<li><code>strictActionSerializability</code>: Actions m√ºssen serialisierbar sein</li>
</ul>
<p>Die Einstellungen werden einzeln aktiviert:</p>
<pre><code class="language-typescript"><span class="hljs-comment">// Runtime Checks aktivieren</span>
<span class="hljs-variable">@NgModule</span>({
  <span class="hljs-attribute">imports</span>: [
    <span class="hljs-comment">// ...</span>
    StoreModule.forRoot(reducers, {
      <span class="hljs-attribute">runtimeChecks</span>: {
        <span class="hljs-attribute">strictStateImmutability</span>: true,
        <span class="hljs-attribute">strictActionImmutability</span>: true,
        <span class="hljs-attribute">strictStateSerializability</span>: true,
        <span class="hljs-attribute">strictActionSerializability</span>: true,
      },
      metaReducers
    })
  ]
})
export class AppModule { }
</code></pre>
<p>Voraussichtlich mit Version 9 werden die Immutability-Checks im Entwicklungsmodus standardm√§√üig aktiviert.
Mehr Infos zu den Runtime Checks und Beispiele finden Sie in der <a href="https://ngrx.io/guide/store/configuration/runtime-checks">Dokumentation von NgRx</a>.</p>
<h2 id="router-store-selektoren-und-forroot">Router Store: Selektoren und <code>forRoot()</code></h2>
<p>Das Modul <code>@ngrx/router-store</code> erm√∂glicht es, den Zustand des Routers ebenfalls √ºber NgRx zu verwalten.
Hier gibt es im neuen Release zwei wichtige √Ñnderungen.</p>
<h3 id="modul-import-mit-forroot">Modul-Import mit <code>forRoot()</code></h3>
<p>Das <code>StoreRouterConnectingModule</code> muss ab sofort mit der Methode <code>forRoot()</code> importiert werden.
Damit wird dieser Import an die herrschende Konvention angeglichen, dass ein gemeinsam genutztes Modul nur Providers mitbringt, wenn es mit <code>forRoot()</code> aufgerufen wird.</p>
<pre><code class="language-typescript"><span class="hljs-comment">// vorher</span>
<span class="hljs-keyword">@NgModule</span>({
  imports: [
    StoreRouterConnectingModule
  ],
  <span class="hljs-comment">// ...</span>
})
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> AppModule { }
</code></pre>
<pre><code class="language-typescript"><span class="hljs-comment">// nachher</span>
<span class="hljs-meta">@NgModule({
  imports: [
    StoreRouterConnectingModule.forRoot()
  ],
  // ...
})</span>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AppModule</span> </span>{ }
</code></pre>
<h3 id="selektoren-f√ºr-router-state">Selektoren f√ºr Router-State</h3>
<p>Zus√§tzlich werden ab sofort einige Selektoren mitgeliefert, um den Router-State effizient auszulesen.
So k√∂nnen mit den neuen Selektoren unter anderem die URL und Routenparameter erfasst werden, um sie in Selektoren und Komponenten zu verwenden.</p>
<pre><code class="language-typescript"><span class="hljs-keyword">import</span> { getSelectors, RouterReducerState } <span class="hljs-keyword">from</span> <span class="hljs-string">'@ngrx/router-store'</span>;
    
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> selectRouter =
  createFeatureSelector&lt;State, RouterReducerState&lt;<span class="hljs-built_in">any</span>&gt;&gt;(<span class="hljs-string">'router'</span>);
    
<span class="hljs-keyword">const</span> {
  selectRouteParams,
  selectQueryParams,
  selectRouteData,
  selectUrl
} = getSelectors(selectRouter);
</code></pre>
<h2 id="sonstiges">Sonstiges</h2>
<p>Das neue Release bringt noch einige weitere √Ñnderungen und Neuigkeiten mit sich.
Wir m√∂chten deshalb auf den <a href="https://ngrx.io/guide/migration/v8">offiziellen Migrationsleitfaden</a> und auf den <a href="https://github.com/ngrx/platform/blob/master/CHANGELOG.md">Changelog von NgRx</a> verweisen, wo Sie stets Informationen zu neuen Features erhalten.</p>
<p><small>Vielen Dank an <strong>Johannes Hoppe</strong> f√ºr Review und Erg√§nzungen!</small><br>
<small><strong>Titelbild:</strong> Zabriskie Point, Death Valley National Park, California, 2019. Foto von Ferdinand Malcher</small></p>
</p><!----><!----><a routerlink="/blog" ripple-radius="" class="btn btn-sm btn-primary mt-4" href="/blog"><i class="fa fa-backward mr-2"></i> Zur√ºck</a><hr> Suggestions? Feedback? Bugs? Please <a target="_blank" class="content" href="https://github.com/angular-buch/website-articles/blob/gh-pages/blog/2019-06-ngrx8/README.md"><i class="fa fa-github mr-1" style="font-size: 1.6rem; position: relative; bottom: -3px;"></i>fork/edit this page on Github</a>. </div></div></div></div></div><!----></div><!----></div></section><ngx-json-ld><script type="application/ld+json">{
  "url": "https://angular.schule/blog/2019-06-ngrx8",
  "headline": "NgRx v8 ‚Äì das neue Major-Release ist da",
  "description": "P√ºnktlich zum Pfingstwochenende wurde am 7. Juni 2019 die neue Major-Version von NgRx ver√∂ffentlicht!\nDas neue Release 8.0.0 bringt einige Neuerungen mit sich, die vor allem die Produktivit√§t des Entwicklers verbessern sollen.\nDas wahrscheinlich wichtigste Feature sind die neuen Creator-Funktionen f√ºr Actions, Reducer und Effects.\nDazu kommt eine Reihe von kleineren Features, die wir in diesem Blogartikel vorstellen m√∂chten.",
  "datePublished": "2019-06-07",
  "dateModified": "2019-06-07",
  "publisher": {
    "name": "Angular-Buch",
    "url": "https://angular-buch.com",
    "@type": "Organization",
    "logo": {
      "@type": "ImageObject",
      "url": "https://angular-buch.com/assets/img/brand_export.png"
    }
  },
  "image": "https://website-articles.angular-buch.com/blog/2019-06-ngrx8/./ngrx8.jpg",
  "thumbnailUrl": "https://website-articles.angular-buch.com/blog/2019-06-ngrx8/./ngrx8.jpg",
  "author": {
    "@type": "Person",
    "name": "Ferdinand Malcher",
    "email": "mail@fmalcher.de"
  },
  "keywords": [
    "NgRx",
    "Redux",
    "Angular",
    "State Management"
  ],
  "mainEntityOfPage": "http://schema.org/WebPage",
  "@type": "Article",
  "@context": "http://schema.org"
}</script></ngx-json-ld></app-blog-details><!----><footer><div class="container"><div class="row align-items-center"><div class="col-sm-9"><div class="links"><app-link><!----><!----><!----><a routerlinkactive="nav__current" ariacurrentwhenactive="page" class="links__item" href="/"><!----> Home </a><!----><!----><!----></app-link>|<!----><app-link><!----><!----><a routerlinkactive="nav__current" ariacurrentwhenactive="page" class="links__item" href="/impressum"><!----> Impressum </a><!----><!----><!----><!----></app-link>|<!----><app-link><!----><!----><a routerlinkactive="nav__current" ariacurrentwhenactive="page" class="links__item" href="/datenschutz"><!----> Datenschutzerkl√§rung </a><!----><!----><!----><!----></app-link>|<!----><app-link><!----><a class="links__item links__twitter" href="https://twitter.com/angular_buch" rel="nofollow"><!----> Twitter </a><!----><!----><!----><!----><!----></app-link><!----><!----></div></div><div class="col-sm-3 text-right"></div></div></div></footer></main><ngx-json-ld><script type="application/ld+json"></script></ngx-json-ld><ngx-json-ld><script type="application/ld+json"></script></ngx-json-ld></app-root>
<script src="runtime.9ffd218b760ae71c.js" type="module"></script><script src="polyfills.6d539c7e65933a8f.js" type="module"></script><script src="main.673db67e5ac17544.js" type="module"></script>

</body></html>